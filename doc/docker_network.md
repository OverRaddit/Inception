# Docker Network

- 도커 컨테이너는 호스트 내부에 격리된 어플리케이션 환경을 생성한다.
- 각 App은 네트워크를 통해 내/외부와 통신한다.
- 도커엔진은 이 컨테이너들이 호스트의 네트워크를 사용할 수 있도록 내부IP를 할당.
- 내부IP는 도커 내부에서만 사용한다.
  - 도커 엔진은 컨테이너가 외부와 통신하기 위해 호스트에 컨테이너를 위한 가상 네트워크 인터페이스를 생성한다.

## veth, eth0

veth : 도커엔진이 호스트에 생성한 가상 네트워크 인터페이스
	컨테이너별로 생성된 veth는 컨테이너 내부 eth0 와 연결됨
	실제로 외부와 통신가능
	veth로 시작하는 이름을 가짐

호스트의 veth, 컨테이너의 eth0가 연결되어도
호스트의 eth0와는 연동되지 않아 아직 통신할 수 없다.

docker0를 veth, eth0(Host)중간에 넣어 연결한다.
docker0 브릿지는 veth, 호스트의 eth0를 바인딩한다.

## Network Driver

위 형태로 연동되는 형식은 도커의 브릿지 네트워크 드라이버 사용방식이다.
도커에는 여러 네트워크 드라이버가 존재한다.

### Bridge
- 디폴트
- 컨테이너가 독립형으로 통신해야할 때 사용하는 것이 일반적
- 외부네트워크와 연결되지 않은 다른 컨테이너와의 연결을 격리한다.
  - => Inception에서 원하는 방식은 아닌 것 같은데....?

- 기본으로 제공되는 브릿지와 사용자가 정의한 브릿지가 다르다?
  - 컨테이너에 네트워크를 명시하지 않아서 할당되는 기본 Bridge 네트워크는 이 기능을 제공하지 않았고, 사용자가 정의하여 추가된 Bridge 네트워크는 이 기능을 제공한다는 것이다....

### Host
- 컨테이너와 호스트의 네트워크 격리를 제거한다.
- 즉, 컨테이너는 호스트의 네트워크를 그대로 이용할 수 있게 된다.
- 별도의 포트포워딩 작업이 생략됨.
- 컨테이너의 내부 IP를 할당해주지 않는다.

### Macvlan
- 외부 물리 네트워크 장치를 사용하여 컨테이너의 가상 네트워크 인터페이스에
  MAC주소를 할당하여 물리적으로 연결된 물리 네트워크 장비처럼 작동하게 만듬.
- Docker Demon은 MAC 주소를 최우선으로 라우팅 한다.

### Overlay
여러 도커 데몬을 연결할 때 사용한다.
docker swarm 서비스와 독립실행 컨테이너간, 혹은 서로다른 docker 데몬에 있는 두개의 독립 실행형 컨테이너간의 통신이 필요할 때 사용한다.

### None
- 도커 데몬에 별도 네트워크를 할당하지 않는다.


# Subject에 어떻게 적용할까..

ContainerDB, ContainerWordpress+PHP는 브릿지로.
ContainerNGINX와 외부는 호스트로!

각 컨테이너별로 네트워크드라이버방식을 설정하는건가?
두 컨테이너가 서로다른 네트워크드라이버방식을 가지고있으면 어떻게 되지?