

## 컨테이너

- 다양한 프로그램, 실행환경을 컨테이너로 추상화하고 동일한 인터페이스를 제공
=> 프로그램의 배포 및 관리를 단순화한다.
- (배에 실는 네모난 화물 수송용 박스처럼,,)
- WAS서버, DB서버, 메시지 큐서버등 어떤 프로그램도 컨테이너로 추상화할 수 있다.
- 이것은 OP서버, AWS, Azure, GCP 등에서 실행할 수 있다.

- 가상화 기술
## 리눅스 컨테이너(LXC)

LXC란 시스템으로부터 나머지 부분과 분리된 1개 이상의 프로세스 세트이다.
  - **namespace**	: 독립된 공간에 대한 제어
    - mnt(파일시스템 마운트)
    - pid : 독립적인 프로세스 공간을 할당
    - net : namespace간에 network 충돌 방지(중복 포트바인딩 등)
    - ipc : 프로세스간의 독립적인 통신통로 할당
    - uts : 독립적인 호스트네임 할당
    - user: 독립적인 사용자 할당
  - **cgroups**		: 독립된 자원에 대한 제어
    - os가 관리하는 다양한 리소스를 중앙에서 제어하기 위한 도구
    - 리소스 목록
      - Memory
      - CPU
      - I/O
      - Network
      - Device node(/dev/)

  - 위 2가지를 통해 독립적인 "컨테이너"가 하나의 리눅스 인스턴스 안에서 실행할 수 있게 함.

  - 가상머신과는 다르게 가상화 계층이 없ㄷㅏ
  - 도커는 리눅스 컨테이너를 다루는 도구중의 하나이며 도커와 같은 다른 도구들도 있으나 대부분 도커를 사용한다. 컨테이너 런타임이라고도 한다.
- chroot
  - 프로세스의 루트 디렉토리를 변경한다
    - 프로세스가 액세스 할 수 있는 디렉토리를 제한함
    - 시스템 라이브러리와 관련 라이브러리를 로드할 수 있다.

- 하이퍼바이징
  - 2가지 타입 존재
    - 1. Bare-Metal형	: 호스트OS ㄴㄴ
    - 2. Host형			: 호스트OS위에서 응용프로그램처럼 동작
  - 가상화 방식 2가지 <- 보충필요
    - 1. 전가상화		: 하드웨어를 완전히 가상화함 -> 게스트OS의 요청이 HyperVisor 통해 호스트OS로 감 => VMware
    - 2. 반가상화
      - HyperVisor가 하드웨어에 요청을 날림.
      - 로우레벨의 커널드라이브를 보유해야함
      - 게스트OS가 Hypervisor에게 요청을 함. 하이퍼바이저의 커널드라이브와의 통신을 위해 수정이 필요함 -> 번거롭기때문에 도입이 어렵다.


- 컨테이너 가상화
컨테이너 가상화는 호스트 운영체제에서 논리적인 구역들을 만들어서 각각 독립적으로 애플리케이션을 실행하는 기술이다. 리소스를 효율적으로 사용하거나 애플리케이션들을 빠르게 배포할 수 있다.


## DOCKER

- 리눅스의 응용 프로그램들을 소프트웨어 컨테이너 안에 배치시키는 일을 자동화하는 OSSW
- 컨테이너 기반의 오픈소스 가상화 플랫폼
- go언어로 개발됨
- 0.9 version이후 LXC -> 직접만든 자체컨테이너를 사용
- 도커컨테이너
- 도커이미지
  - 설정을 이미지 파일로 저장 + 실행할 수 있다 -> 깃과의 연동도 용이

### Docker가 없던 시절

- OS~ 서버 응용프로그램이 돌아가기 위한 프레임워크 설치, 서버 응용프로그램 설치, 사용하기 위한 기반 플러그인 프로그램 설치...
  - 꼬이면 다시

- 어떤 서비스가 점차 확장되어 많은 서버와 리소스를 가지고 운영을 해야하는 상황
  - 물리적인 하드웨어와 자주 발생하는 서비스 배포의 관계가 1,2개 ~ 수백만서버와 배포를
    관리하기 위해서는 기존의 방식(VM)으로 감당이 어려워짐.


# THINK

- 도커이미지를 통해 하나의 환경을 설정 가능
  - 왜 하나의 이미지에 다 때려박지 않고 여러 이미지에 넣나?
  - 하나의 이미지에서 설정할 수 있는 범위는?
- 특정 서버의 방대한 설정을 하나의 이미지가 아닌 여러 이미지의 조합으로 나타냄.
- 이미지는 하나의 환경만 구현해주므로, 여러 이미지가 조합된 환경을 나타낼 방법이 필요함.

## 가상화기술과 컨테이너기술 차이점

가상머신
- 게스트OS필요
- 자원이 필요하면 스케일업
- 유휴자원을 사용할 수 없다.

컨테이너
- 자원필요시 컨테이너를 스케일아웃
- 게스트os ㄴㄴ
- 유휴자원을 사용할 수 있어 효율성높음

- 경량화